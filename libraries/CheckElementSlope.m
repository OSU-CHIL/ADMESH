function MESH = CheckElementSlope(MESH)

%--------------------------------------------------------------------------
% Check element slope
%--------------------------------------------------------------------------
[ts,~,~] = triSlopeVector(MESH);

%--------------------------------------------------------------------------
% Check if zero-slope elements exist
%--------------------------------------------------------------------------
[I,~] = find(isnan(ts));
I = unique(I);

%--------------------------------------------------------------------------
% Quit if all elements have non-zero slope
%--------------------------------------------------------------------------
if isempty(I)
    return;
end

%--------------------------------------------------------------------------
% Modify node elevation (arbitrarily select a node on zero-slope element)
%--------------------------------------------------------------------------
P = MESH.Points;
T = MESH.ConnectivityList;
P(T(I,3),3) = P(T(I,3),3)*1.00006;

%--------------------------------------------------------------------------
% Modify MESH
%--------------------------------------------------------------------------
MESH.Points = P;

%--------------------------------------------------------------------------
% Fill sink in case the modification creates new sink
%--------------------------------------------------------------------------
MESH.Points(:,3) = -MESH.Points(:,3);
MESH = fillSinks(MESH);
MESH.Points(:,3) = -MESH.Points(:,3);


